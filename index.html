<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Driving Range Tracker</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>Driving Range Tracker</h1>
    <nav class="nav">
      <button class="nav__btn" data-target="loggerView" aria-selected="true">Logger</button>
      <button class="nav__btn" data-target="historyView">History</button>
    </nav>
  </header>

  <main>
    <!-- LOGGER (Session Buffer) -->
    <section id="loggerView" class="view view--active">
      <div class="card">
        <form id="swingForm" autocomplete="off">
          <div class="grid">
            <label class="field">
              <span>Club</span>
              <select id="clubType" required>
                <optgroup label="Driver"><option>Driver</option></optgroup>
                <optgroup label="Woods">
                  <option>3 Wood</option><option>4 Wood</option>
                  <option>5 Wood</option><option>7 Wood</option>
                </optgroup>
                <optgroup label="Irons">
                  <option>1 Iron</option><option>2 Iron</option><option>3 Iron</option>
                  <option>4 Iron</option><option>5 Iron</option><option>6 Iron</option>
                  <option>7 Iron</option><option>8 Iron</option><option>9 Iron</option>
                </optgroup>
                <optgroup label="Wedges">
                  <option>Pitching Wedge</option><option>Gap Wedge</option>
                  <option>Sand Wedge</option><option>Lob Wedge</option>
                </optgroup>
                <optgroup label="Other"><option>Other</option></optgroup>
              </select>
            </label>

            <label class="field" id="otherClubWrap" hidden>
              <span>Custom Club</span>
              <input id="otherClub" type="text" placeholder="e.g., 2 Hybrid, 64Â° Wedge" />
            </label>

            <label class="field chk">
              <input id="isHybrid" type="checkbox" />
              <span>Hybrid</span>
            </label>

            <label class="field">
              <span>Distance (yds)</span>
              <!-- free-form; we reset it to "0" after each add -->
              <input id="distance" type="text" placeholder="e.g., 165 or 'long drive'" required />
            </label>

            <label class="field">
              <span>Shot Shape</span>
              <select id="shape" required>
                <option>Straight</option><option>Draw</option><option>Fade</option>
                <option>Hook</option><option>Slice</option><option>Pull</option><option>Push</option>
              </select>
            </label>

            <label class="field">
              <span>Date & Time</span>
              <input id="date" type="datetime-local" required />
            </label>
          </div>

          <div class="actions">
            <button type="submit" class="btn primary">Add Swing</button>
            <button type="button" id="clearDistance" class="btn">Clear Distance</button>
            <button type="button" id="saveSession" class="btn primary">Save Data âžœ History</button>
            <button type="button" id="resetSelections" class="btn danger">Reset Selections</button>
          </div>
        </form>
      </div>

      <div class="card">
        <h3>Session Summary (unsaved swings)</h3>
        <div id="sessionSummary" class="summary"></div>
      </div>

      <div class="card">
        <h3>Latest Session Swings</h3>
        <div class="table-wrap">
          <table class="table" id="latestTable">
            <thead>
              <tr><th>Date</th><th>Club</th><th>Hyb</th><th>Distance</th><th>Shape</th><th></th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <p class="small">These are in your current session only. Click <b>Save Data</b> to move them to History.</p>
      </div>

      <div class="card danger">
        <div class="row">
          <h3>Reset All</h3>
          <button id="resetAll" class="btn danger">Delete ALL Data (Session + History)</button>
        </div>
      </div>
    </section>

    <!-- HISTORY (Persisted after Save Data) -->
    <section id="historyView" class="view">
      <div class="card">
        <div class="row">
          <h2>History</h2>
          <button class="btn" data-target="loggerView">Back</button>
        </div>

        <div class="row" style="gap:.6rem; align-items:center;">
          <label class="field" style="max-width:300px;">
            <span>Filter by Club</span>
            <select id="historyClubFilter">
              <option value="__all__">All Clubs</option>
              <!-- clubs injected -->
            </select>
          </label>
        </div>

        <div id="historyStats" class="stats" style="margin-top:.6rem"></div>
      </div>

      <div class="card">
        <h3>Shapes Breakdown (filtered)</h3>
        <canvas id="shapesChart" height="110"></canvas>
      </div>

      <div class="card">
        <h3>Per-Club Longest â€¢ Avg â€¢ Shortest (history/filtered)</h3>
        <canvas id="historyBars" height="120"></canvas>
      </div>

      <div class="card">
        <h3>Saved Swings</h3>
        <div class="table-wrap">
          <table class="table" id="historyTable">
            <thead>
              <tr><th>Date</th><th>Club</th><th>Hyb</th><th>Distance</th><th>Shape</th><th>Actions</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <p class="small">Only swings saved from the Logger appear here.</p>
      </div>
    </section>
  </main>

  <div id="toast"></div>
  <footer class="footer"><small>Local-only data. ðŸ”¨ðŸ¤–ðŸ”§</small></footer>
  <script src="app.js"></script>
</body>
</html>
